<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Olaf M. | My Works</title>
    
    <link rel="icon" href="img/use_/fav.png" type="image/png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.bunny.net/css?family=HK+Grotesk:400,700" rel="stylesheet">
    <link href="https://fonts.cdnfonts.com/css/cascadia-code" rel="stylesheet">
    
    <link rel="stylesheet" href="work.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

    <style>
        body {
            overflow-x: hidden;
            min-height: 100vh;
        }

        body.stop-scrolling {
            overflow: hidden !important;
            height: 100vh;
        }

        .site-footer {
            background-color: #000;
            color: #fff;
            font-family: 'HK Grotesk', sans-serif;
            padding: 0 2vw 4rem 2vw;
            position: relative;
            z-index: 10;
        }

        .footer-divider {
            width: 100%;
            height: 1px;
            background-color: rgba(255, 255, 255, 0.2);
            margin-bottom: 3rem;
        }

        .footer-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: flex-start;
            gap: 3rem;
        }

        .footer-left {
            flex: 0 1 350px;
            max-width: 350px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .footer-cta {
            font-size: 0.95rem;
            line-height: 1.6;
            text-align: justify;
            margin-bottom: 2rem;
            opacity: 0.9;
            color: #d1d1d1;
        }

        .copyright {
            font-size: 0.7rem;
            opacity: 0.5;
            margin-top: auto;
            font-family: 'HK Grotesk', sans-serif;
        }

        .footer-right {
            flex: 0 1 auto; 
            display: grid;
            grid-template-columns: repeat(3, 250px); 
            gap: 4rem; 
            
            text-align: left;
        }

        .footer-col {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .footer-subject {
            font-family: 'HK Grotesk', sans-serif;
            font-weight: 500;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 0.5rem;
        }

        .footer-col a, .footer-col span {
            color: #fff;
            text-decoration: none;
            font-size: 0.95rem;
            transition: opacity 0.3s ease;
            line-height: 1.5;
            white-space: nowrap;
            cursor: none; 
        }

        .footer-col a:hover {
            opacity: 0.6;
        }

        .site-footer {
            background-color: #000;
        }
        body.light-mode-active .site-footer {
            background-color: #fcfcfc;
            color: #111;
        }
        body.light-mode-active .footer-divider {
            background-color: rgba(0, 0, 0, 0.15);
        }
        body.light-mode-active .footer-cta {
            color: #444;
        }
        body.light-mode-active .footer-subject {
            color: rgba(0, 0, 0, 0.5);
        }
        body.light-mode-active .footer-col a, 
        body.light-mode-active .footer-col span {
            color: #111;
        }
        body.light-mode-active .copyright {
            color: #666;
        }

        @media (max-width: 1024px) {
            .footer-right {
                gap: 2rem;
            }
        }

        @media (max-width: 768px) {
            .site-footer {
                padding-bottom: 2rem;
            }
            .footer-container {
                flex-direction: column;
                gap: 3rem;
            }
            .footer-left {
                max-width: 100%;
                flex: 1 1 auto;
            }
            .footer-right {
                width: 100%;
                grid-template-columns: 1fr;
                gap: 2.5rem;
            }
            .footer-col a, .footer-col span {
                white-space: normal;
            }
        }
    </style>
</head>

<body class="stop-scrolling">
    
    <div id="preloader" style="
        position: fixed; 
        top: 0; left: 0; 
        width: 100%; height: 100%; 
        background-color: #000; 
        z-index: 99999; 
        display: flex; 
        justify-content: center; 
        align-items: center;
    ">
        <div class="preloader-text" style="
            font-family: 'Cascadia Mono ExtraLight', monospace;
            font-size: clamp(20px, 4vw, 40px); 
            color: white; 
            letter-spacing: 5px; 
            text-transform: uppercase;
            opacity: 0; 
        ">
            OLAF M. | MY WORKS
        </div>
    </div>

    <div id="custom-cursor"></div>

    <div id="transition-overlay"></div> 

    <div class="work-page-container">
        
        <div class="work-header-title">
            OLAF M. | MY WORKS
            <span class="header-subtitle">graphics designer & web designer</span>
        </div>

        <div class="header-controls">
            <a href="https://olafmarcinkowski.pl/prace" class="lang-link">
                <img src="img/use_/lang.png" alt="Language / Język" class="lang-icon" id="lang-icon">
                <span class="lang-text" id="lang-text">PL</span> 
            </a>

            <div class="theme-switch-icons">
                <img src="img/use_/light.png" alt="Light Mode" id="light-icon" class="mode-icon active-mode-icon">
                <img src="img/use_/dark.png" alt="Dark Mode" id="dark-icon" class="mode-icon">
            </div>

            <a href="index.html" class="header-back-link" id="back-link">
                <span>Back</span>
            </a>
        </div>
        
        <section class="portfolio-section">
            
            <div class="portfolio-visuals">
                
                <div class="card-stack-wrapper"> 
                    <div class="card-stack">
                        <div class="portfolio-card" data-index="0"><img src="" alt="Preview"></div>
                        <div class="portfolio-card" data-index="1"><img src="" alt="Preview"></div>
                        <div class="portfolio-card" data-index="2"><img src="" alt="Preview"></div>
                        <div class="portfolio-card" data-index="3"><img src="" alt="Preview"></div>
                        <div class="portfolio-card" data-index="4"><img src="" alt="Preview"></div>
                    </div>
                </div>

            </div>

            <div class="portfolio-info">
                <div class="info-header">
                    <h2 id="info-title" class="info-title"></h2>
                    <span id="info-date" class="info-date"></span>
                </div>
                <p id="info-description-1" class="info-description-1"></p>
                <p id="info-description-2" class="info-description-2"></p>
                
                <a href="https://www.instagram.com/solendz_caravan/" target="_blank" id="read-more-btn" class="nav-btn read-more-link" style="display: none; margin-top: 20px; text-decoration: none;">
                    Read More
                </a>
                
                <div class="info-counter">
                    <span id="current-index">1</span>/<span id="total-works">8</span>
                </div>

                <div class="portfolio-controls-desktop">
                    <button id="prev-btn-desktop" class="nav-btn">Prev</button>
                    <button id="next-btn-desktop" class="nav-btn">Next</button>
                </div>
            </div>

        </section>
        
        <div class="portfolio-controls-mobile">
            <button id="prev-btn-mobile" class="nav-btn">Prev</button>
            <button id="next-btn-mobile" class="nav-btn">Next</button>
        </div>

        <section class="methodology-section">
            <div class="methodology-header">
                <span class="section-label">PROCESS</span>
                <h2 class="methodology-title">Digital Craftsmanship</h2>
            </div>
            <div class="methodology-grid">
                <div class="method-item">
                    <div class="method-number">01</div>
                    <h3 class="method-name">Raw Concept</h3>
                    <p class="method-desc">I reject the reliance on templates. Every project begins as a blank canvas where logic meets intuition. I deconstruct the user's journey to build an interface that feels not just functional, but inevitable.</p>
                </div>
                <div class="method-item">
                    <div class="method-number">02</div>
                    <h3 class="method-name">Visual Translation</h3>
                    <p class="method-desc">Using advanced retouching and custom asset creation, I translate abstract ideas into pixel-perfect visuals. My design philosophy balances negative space with typographic tension to guide the eye naturally.</p>
                </div>
                <div class="method-item">
                    <div class="method-number">03</div>
                    <h3 class="method-name">The Code Engine</h3>
                    <p class="method-desc">I write my own code. By bypassing heavy frameworks in favor of native HTML5, WebGL, and GSAP, I ensure that animations are fluid and performance remains uncompromised. It is engineering serving art.</p>
                </div>
            </div>
            <div class="methodology-footer">
                <p>"Design is not just about how it looks. It is about how it feels to interact with the invisible architecture of the web."</p>
            </div>
        </section>

    </div> 

    <footer class="site-footer">
        <div class="footer-divider"></div>
        <div class="footer-content">
            <div class="footer-container">
                <div class="footer-left">
                    <p class="footer-cta">Ready to elevate your digital presence? Feel free to reach out — I’m open to inquiries and collaboration opportunities!</p>
                    <p class="copyright">All right reserved 2025 ©</p>
                </div>
                <div class="footer-right">
                    <div class="footer-col">
                        <div class="footer-subject">Contents</div>
                        <a href="index.html">Home</a>
                        <a href="index.html">About me</a>
                        <a href="works.html">Works</a>
                    </div>
                    <div class="footer-col">
                        <div class="footer-subject">Contact</div>
                        <a href="https://www.instagram.com/solendz_caravan/" target="_blank">@solendz_caravan</a>
                        <a href="mailto:olo.marcinkowski@gmail.com">olo.marcinkowski@gmail.com</a>
                    </div>
                    <div class="footer-col">
                        <div class="footer-subject">Me</div>
                        <span>Olaf Marcinkowski</span>
                        <span>Grudziądz, 86-300, PL</span>
                        <span style="margin-top: 5px;">graphics designer &<br>web designer</span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

<script src="preloader.js"></script>

<script>
    const worksData = [
        { 
            title: "UI Concept and Front-End Build", 
            date: "2025-03-12", 
            description1: "This project focused on developing a detailed custom mock-up and initial front-end scripting for a film maker and film director’s professional website.", 
            description2: "All graphic elements, layouts, and visual components were handcrafted by me, creating a unique and original design style. The photos and visual materials provided for the project were carefully retouched and adapted to fit the artistic direction and technical needs of the interface.",
            image: "document1.png" 
        },
        { 
            title: "Motion Homepage Prototype", 
            date: "2025-03-01", 
            description1: "This project showcases a motion-based homepage concept for a film studio, featuring a dynamic rotating gallery and smooth cinematic transitions. The animation demonstrates how key hero elements and visual content would behave in an interactive, real-time UI environment.", 
            description2: "The mock-up also outlines the core front-end structure, including planned interaction logic, hover states, and navigation flow. All visual components were custom-designed to match the studio’s aesthetic and support a clean, functional user experience.",
            image: "document2.gif" 
        },
        { 
            title: "Personal Introduction Page", 
            date: "2025-02-15", 
            description1: "A digital mockup and conversational-tech demo built to showcase a modern athlete-focused experience featuring marathon runner Jason Smith.", 
            description2: "The full visual framework — layout, branding elements, and interface components — was designed entirely by me, with all images carefully prepared and optimized for seamless display. The prototype includes a custom-crafted HTML structure, interaction logic enabling fluid conversations with Jason’s virtual agent, and tailored styling to ensure clarity, responsiveness, and an intuitive user flow.",
            image: "document3.png" 
        },
        { 
            title: "Portfolio Prototype", 
            date: "2024-02-28", 
            description1: "A clean and minimalist web portfolio created to highlight the work and artistic style of a Czech photographer.", 
            description2: "The entire visual presentation — layout structure, typography, and interface elements — was crafted by me to emphasize clarity and understated elegance. All photographs were carefully prepared for web use to retain detail while ensuring fast loading. The build features a lightweight HTML foundation, subtle interface interactions, and custom styling designed to present her work in a refined, distraction-free viewing experience.",
            image: "document4.png" 
        },
        { 
            title: "Community Blog Prototype", 
            date: "2025-01-11", 
            description1: "A community-oriented website concept designed to support a restoration project and provide a clean, easy-to-manage blogging platform.", 
            description2: "The entire visual layer — layouts, graphics, and interface components was handcrafted by me, with all supplied photos carefully edited and optimized for web use. The build included HTML structure, JavaScript functionality for interactive elements, and custom styling to ensure a lightweight and responsive user experience.",
            image: "document5.png" 
        },
        { 
            title: "Personal Portfolio", 
            date: "2025-12-17", 
            description1: "A compact showcase of my design prototypes, interfaces, and technical experiments. I created the full visual structure of the site, keeping it clean, lightweight, and consistent across all featured projects.", 
            description2: "One highlight is my custom WebGL2 engine, where the sky, ocean and celestial elements are generated procedurally in GLSL. Rendering runs on a single fullscreen quad with most calculations handled on the GPU, while JavaScript manages only camera and time controls.",
            image: "document6.png" 
        },
        { 
            title: "WebGL Particle Morphing", 
            date: "2024-11-20", 
            description1: "An interactive 3D particle experience built with Three.js, where text and icons dynamically morph into different shapes. I designed the full visual interface, keeping it sleek, responsive, and focused on smooth animations.", 
            description2: "A key feature is the custom particle shader system, with GLSL handling morphing, color, and mouse-based interactions entirely on the GPU, while JavaScript manages particle targets, animation timing, and user input.",
            image: "document7.gif" 
        },
        {
            title: "Cozy virtual space - Catchin' Club", 
            date: "in production since 2025-01-05", 
            description1: "Catching Club is a solo-developed, relaxing concept project for an anonymous MMO. The game focuses on social interactions, fishing, and building acquaintances. All pixel-art visual assets were personally designed and created by me.", 
            description2:"It utilizes an advanced, custom P2P architecture built on WebRTC and the PeerJS library, with all server logic and synchronization managed by my original dedicated Game Host Worker, eliminating the need for traditional server infrastructure.",
            image: "document8.png" 
        }
    ];

    const CARD_COUNT = worksData.length; 
    const TRANSITION_DURATION = 0.8; 
    let isAnimating = false;
    const VISIBLE_LIMIT = 4; 
    const isMobile = window.innerWidth <= 1024; 

    const DESKTOP_PROPS = {
        0: { z: 10, rotationY: -6, scale: 1, x: '0%', opacity: 1, zIndex: 5 },
        1: { z: 5, rotationY: -5, scale: 0.98, x: '2%', opacity: 1, zIndex: 4 },
        2: { z: 4, rotationY: -4, scale: 0.96, x: '4%', opacity: 0.8, zIndex: 3 },
        3: { z: 3, rotationY: -3, scale: 0.94, x: '6%', opacity: 0.4, zIndex: 2 },
        4: { z: 2, rotationY: -2, scale: 0.92, x: '8%', opacity: 0, zIndex: 1 },
    };
    
    const MOBILE_PROPS = {
        0: { z: 10, rotationY: -3, scale: 1, x: '0%', opacity: 1, zIndex: 5 },
        1: { z: 5, rotationY: -2, scale: 0.98, x: '1%', opacity: 1, zIndex: 4 },
        2: { z: 4, rotationY: -1, scale: 0.96, x: '2%', opacity: 0.8, zIndex: 3 },
        3: { z: 3, rotationY: 0, scale: 0.94, x: '3%', opacity: 0.4, zIndex: 2 },
        4: { z: 2, rotationY: 0, scale: 0.92, x: '4%', opacity: 0, zIndex: 1 }, 
    };
    
    const CARD_PROPS = isMobile ? MOBILE_PROPS : DESKTOP_PROPS;


    function updateCardState(cards) {
        cards.forEach((card, index) => {
            const props = CARD_PROPS[index] || CARD_PROPS[VISIBLE_LIMIT]; 
            const workIndex = parseInt(card.dataset.workIndex);
            if(workIndex >= 0 && workIndex < worksData.length) {
                card.querySelector('img').src = `img/work_/${worksData[workIndex].image}`; 
            }
            const finalOpacity = index > VISIBLE_LIMIT ? 0 : props.opacity;
            gsap.to(card, {
                duration: TRANSITION_DURATION,
                x: props.x,
                y: 0, 
                rotationY: props.rotationY,
                scale: props.scale,
                opacity: finalOpacity,
                zIndex: props.zIndex,
                ease: "power3.inOut"
            });
        });
    }

    function initialCardLoadAnimation(cards) {
        cards.forEach((card, index) => {
            const props = CARD_PROPS[index] || CARD_PROPS[VISIBLE_LIMIT];
            card.style.zIndex = props.zIndex;
            const workIndex = parseInt(card.dataset.workIndex);
            if(workIndex >= 0 && workIndex < worksData.length) {
                card.querySelector('img').src = `img/work_/${worksData[workIndex].image}`; 
            }
        });
        
        gsap.set(cards, { x: '-100vw', y: '0%', rotationY: -60, scale: 0.8, opacity: 0, visibility: 'visible' });

        const tl = gsap.timeline({ onComplete: () => { isAnimating = false; } });
        
        for (let i = cards.length - 1; i >= 0; i--) {
            const card = cards[i];
            const props = CARD_PROPS[i] || CARD_PROPS[VISIBLE_LIMIT];
            const finalOpacity = i > VISIBLE_LIMIT ? 0 : props.opacity;
            
            tl.to(card, {
                duration: 1.0, 
                x: props.x,
                y: 0, 
                rotationY: props.rotationY,
                scale: props.scale,
                opacity: finalOpacity,
                ease: "power3.out" 
            }, (cards.length - 1 - i) * 0.08); 
        }
    }

    function updateText(data) {
        const titleEl = document.getElementById('info-title');
        const dateEl = document.getElementById('info-date');
        const desc1El = document.getElementById('info-description-1');
        const desc2El = document.getElementById('info-description-2');
        const readMoreBtn = document.getElementById('read-more-btn'); 

        const isCatchinClub = data.title.includes("Cozy virtual space - Catchin' Club"); 
        
        if (readMoreBtn) {
            gsap.set(readMoreBtn, { display: 'none' });
        }


        gsap.to([titleEl, dateEl, desc1El, desc2El], { 
            opacity: 0, filter: 'blur(8px)', duration: TRANSITION_DURATION / 2,
            onComplete: () => {
                titleEl.textContent = data.title;
                dateEl.textContent = data.date;
                desc1El.textContent = data.description1;
                desc2El.textContent = data.description2;
                
                if (readMoreBtn && isCatchinClub) {
                    gsap.set(readMoreBtn, { opacity: 0, display: 'inline-block' });
                }

                gsap.to([titleEl, dateEl, desc1El, desc2El], { 
                    opacity: 1, filter: 'blur(0px)', duration: TRANSITION_DURATION / 2, delay: 0.1, ease: "power3.out"
                });
                
                if (readMoreBtn && isCatchinClub) {
                    gsap.to(readMoreBtn, { 
                        opacity: 1, duration: TRANSITION_DURATION / 2, delay: 0.1, ease: "power3.out"
                    });
                }
            }
        });
    }

    function handleTransition(direction) {
        if (isAnimating) return;
        isAnimating = true;

        const cards = Array.from(document.querySelectorAll('.portfolio-card'));
        const firstCard = cards[0];
        const cardStack = document.querySelector('.card-stack');

        const currentWorkIndex = parseInt(firstCard.dataset.workIndex);
        
        const currentBottomCardIndex = parseInt(cards[cards.length - 1].dataset.workIndex);
        
        const textUpdateIndex = (currentWorkIndex + 1) % worksData.length;
        const newBottomCardIndex = (currentBottomCardIndex + 1) % worksData.length;

        const prevWorkIndex = (currentWorkIndex - 1 + worksData.length) % worksData.length;

        if (direction === 'next') {
            gsap.to(firstCard, {
                x: isMobile ? '-100%' : '-110%', rotationY: -10, scale: 1.1, opacity: 0, duration: TRANSITION_DURATION, ease: "power2.in",
                onComplete: () => {
                    firstCard.dataset.workIndex = newBottomCardIndex; 
                    
                    cardStack.appendChild(firstCard);
                    const lastProps = CARD_PROPS[VISIBLE_LIMIT];
                    gsap.set(firstCard, { x: lastProps.x, rotationY: lastProps.rotationY, scale: lastProps.scale, opacity: 0, zIndex: lastProps.zIndex });
                    updateCardState(Array.from(document.querySelectorAll('.portfolio-card')));
                    isAnimating = false;
                }
            });
            updateText(worksData[textUpdateIndex]); 
            const currentIndexEl = document.getElementById('current-index');
            let currentNum = parseInt(currentIndexEl.textContent);
            currentNum = (currentNum % CARD_COUNT) + 1;
            currentIndexEl.textContent = currentNum;

        } else if (direction === 'prev') {
            const lastCard = cards[cards.length - 1]; 
            lastCard.dataset.workIndex = prevWorkIndex; 
            gsap.set(lastCard, { x: isMobile ? '-150%' : '-150%', rotationY: -45, scale: 0.8, opacity: 0, zIndex: 10 });
            cards.forEach((card, index) => {
                 const nextProps = CARD_PROPS[index+1] || CARD_PROPS[VISIBLE_LIMIT];
                 gsap.set(card, { zIndex: nextProps ? nextProps.zIndex : 0 });
            });
            cardStack.prepend(lastCard);
            updateCardState(Array.from(document.querySelectorAll('.portfolio-card'))); 
            updateText(worksData[prevWorkIndex]);
            const currentIndexEl = document.getElementById('current-index');
            let currentNum = parseInt(currentIndexEl.textContent);
            currentNum = (currentNum - 2 + CARD_COUNT) % CARD_COUNT + 1;
            currentIndexEl.textContent = currentNum;
            gsap.delayedCall(TRANSITION_DURATION, () => { isAnimating = false; });
        }
    }

    function toggleTheme() {
        const body = document.body;
        const overlay = document.getElementById('transition-overlay');
        const lightIcon = document.getElementById('light-icon');
        const darkIcon = document.getElementById('dark-icon');
        gsap.set(overlay, { visibility: 'visible', pointerEvents: 'all', opacity: body.classList.contains('light-mode-active') ? 0 : 1 });
        gsap.to(overlay, {
            opacity: body.classList.contains('light-mode-active') ? 1 : 0, duration: 0.4, ease: "power2.in", 
            onComplete: () => {
                body.classList.toggle('light-mode-active');
                overlay.style.backgroundColor = body.classList.contains('light-mode-active') ? '#fcfcfc' : '#000';
                lightIcon.classList.toggle('active-mode-icon');
                darkIcon.classList.toggle('active-mode-icon');
                gsap.to(overlay, { opacity: 0, duration: 0.4, ease: "power2.out", onComplete: () => {
                    gsap.set(overlay, { visibility: 'hidden', pointerEvents: 'none' });
                }});
            }
        });
    }

    document.addEventListener("DOMContentLoaded", function() {
        if (history.scrollRestoration) { history.scrollRestoration = 'manual'; }
        window.scrollTo(0, 0);

        const cursor = document.getElementById('custom-cursor');
        const overlay = document.getElementById('transition-overlay');
        const body = document.body;
        
        const transitionLinks = document.querySelectorAll('.header-back-link, .footer-col a, .lang-link');
        
        isAnimating = true; 

        if (overlay) {
            gsap.to(overlay, { opacity: 0, duration: 1.2, ease: "power2.out", onComplete: () => {
                gsap.set(overlay, { visibility: 'hidden', pointerEvents: 'none' });
            }});
        }
        
        if (transitionLinks.length > 0 && overlay) {
            transitionLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    const targetUrl = this.getAttribute('href');
                    
                    if(targetUrl === '#' || targetUrl.startsWith('javascript')) return;

                    if (this.id === 'read-more-btn') return;

                    e.preventDefault(); 
                    
                    gsap.set(overlay, { visibility: 'visible', pointerEvents: 'all', opacity: 0, backgroundColor: '#000' });
                    
                    gsap.to(overlay, { 
                        opacity: 1, 
                        duration: 0.8, 
                        ease: "power2.in", 
                        onComplete: () => { 
                            window.location.href = targetUrl; 
                        }
                    });
                });
            });
        }
        
        let mouseX = 0, mouseY = 0, cursorX = 0, cursorY = 0;
        const speed = 0.15; 
        if (cursor) {
            document.addEventListener('mousemove', function(e) { mouseX = e.clientX; mouseY = e.clientY; });
            function animateCursor() {
                cursorX += (mouseX - cursorX) * speed;
                cursorY += (mouseY - cursorY) * speed;
                cursor.style.left = cursorX + 'px'; cursor.style.top = cursorY + 'px';
                requestAnimationFrame(animateCursor);
            }
            animateCursor();
            document.addEventListener('mousedown', () => cursor.classList.add('click-active'));
            document.addEventListener('mouseup', () => cursor.classList.remove('click-active'));
            const links = document.querySelectorAll('a, button, .header-back-link, input, .nav-btn, .lang-link, .mode-icon, .footer-col a');
            links.forEach(link => {
                link.addEventListener('mouseenter', () => cursor.classList.add('hover-active'));
                link.addEventListener('mouseleave', () => cursor.classList.remove('hover-active'));
            });
        }
        
        const cardStack = document.querySelector('.card-stack');
        const nextBtnDesktop = document.getElementById('next-btn-desktop');
        const prevBtnDesktop = document.getElementById('prev-btn-desktop');
        const nextBtnMobile = document.getElementById('next-btn-mobile');
        const prevBtnMobile = document.getElementById('prev-btn-mobile');
        const totalWorksEl = document.getElementById('total-works');
        const lightIcon = document.getElementById('light-icon');
        const darkIcon = document.getElementById('dark-icon');
        
        if (lightIcon && darkIcon) {
            lightIcon.addEventListener('click', toggleTheme);
            darkIcon.addEventListener('click', toggleTheme);
        }

        if (cardStack) {
            while (cardStack.children.length < 5) {
                const newCard = document.createElement('div');
                newCard.classList.add('portfolio-card');
                const img = document.createElement('img'); img.alt = "Document Preview";
                newCard.appendChild(img); cardStack.appendChild(newCard);
            }
            const cards = Array.from(document.querySelectorAll('.portfolio-card'));
            cards.forEach((card, index) => { card.dataset.workIndex = index; });
            gsap.set(cards, { x: '-100vw', opacity: 0 });
            updateText(worksData[0]); 
            totalWorksEl.textContent = CARD_COUNT; 

            if(nextBtnDesktop) nextBtnDesktop.addEventListener('click', () => handleTransition('next'));
            if(prevBtnDesktop) prevBtnDesktop.addEventListener('click', () => handleTransition('prev'));
            if(nextBtnMobile) nextBtnMobile.addEventListener('click', () => handleTransition('next'));
            if(prevBtnMobile) prevBtnMobile.addEventListener('click', () => handleTransition('prev'));

            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    if (this === document.querySelector('.card-stack').children[0] && !isAnimating) {
                        gsap.to(this, { duration: 0.3, scale: 1.01, rotationY: isMobile ? -1 : -1.5, ease: "power2.out" });
                    }
                });
                card.addEventListener('mouseleave', function() {
                    if (this === document.querySelector('.card-stack').children[0] && !isAnimating) {
                         const originalProps = CARD_PROPS[0];
                         gsap.to(this, { duration: 0.3, scale: originalProps.scale, rotationY: originalProps.rotationY, ease: "power2.out" });
                    }
                });
            });

            const preloader = document.getElementById('preloader');
            if (preloader) {
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.type === "attributes" && mutation.attributeName === "style") {
                            const style = window.getComputedStyle(preloader);
                            if (parseFloat(style.opacity) < 0.9 || style.display === 'none') {
                                document.body.classList.remove('stop-scrolling');
                                initialCardLoadAnimation(cards); 
                                observer.disconnect();
                            }
                        }
                    });
                });
                observer.observe(preloader, { attributes: true });
            } else {
                document.body.classList.remove('stop-scrolling');
                initialCardLoadAnimation(cards);
            }
        }
    });
</script>

</body>
</html>